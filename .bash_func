#!/usr/bin/env bash


clean_boohma_dump() {
  perl -pe 's/\sDEFINER=`[^`]+`@`[^`]+`//' < boohma.sql > boohma_no_definers.sql
}

mv2dir() {
    cd "$HOME/Projects/$1/$2"
}

proj() {
    mv2dir "src" "$1"
}

doc() {
    mv2dir "docker" "$1"
}

g2() {
   mv2dir "go/src/github.com/Billups" "$1"
}

serve() {
    for command in "$@"
    do
        case $command in
            hb )
                (g2 harebrane && \
                go install github.com/Billups/harebrane/cmd/harebraneserver && \
                harebraneserver ./)
                ;;
            geo )
                (g2 geo && \
                go install github.com/Billups/geo/cmd/geoserver && \
                geoserver ./)
                ;;
            gogrid )
                (g2 gogrid && \
                go install github.com/Billups/gogrid/cmd/gogrid && \
                gogrid ./)
                ;;
            demos )
                (proj demos && \
                pyenv exec python run.py)
                ;;
            tiles )
                (proj tilestache && \
                dc up -d)
                ;;
            help)
                echo "usage: serve [demos, geo, gogrid, hb, keycloak, mariadb, nginx, redis, tiles]"
                ;;
            * )
                (doc $1 && \
                dc up -d )
                ;;

        esac
    done
}